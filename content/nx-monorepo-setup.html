<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Creating an Nx Workspace with Shared Components</title>
    <link rel="stylesheet" href="../styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
  </head>
  <body>
    <header>
      <div class="container">
        <div class="logo">
          <h1>sarathmolathoti.me</h1>
        </div>
        <nav>
          <ul>
            <li><a href="../index.html">Home</a></li>
            <li><a href="../categories.html">Categories</a></li>
            <li><a href="../about.html">About</a></li>
            <li><a href="../contact.html">Contact</a></li>
          </ul>
        </nav>
        <div class="search-bar">
          <form id="search-form">
            <input type="text" id="search-input" placeholder="Search..." />
            <button type="submit"><i class="fas fa-search"></i></button>
          </form>
        </div>
      </div>
    </header>

    <main>
      <article class="blog-post">
        <h1>An Introduction to Nx: The Ultimate Tool for Monorepos</h1>
        <p>Posted on August 1, 2024</p>
        <div class="tags">
          <span class="tag">Nx</span>
          <span class="tag">React</span>
          <span class="tag">Monorepo</span>
          <span class="tag">Shared Components</span>
        </div>
        <h2 style="color: #0815ca">What is Nx?</h2>
        <p>
          Nx is a powerful build system with first-class
          <a href="https://en.wikipedia.org/wiki/Monorepo" style="color: blue"
            >monorepo</a
          >
          support and powerful integrations. It enables developers to manage
          multiple projects within a single workspace, making it easier to share
          code, configuration, and tooling across projects. This approach helps
          to maintain consistency, reduce duplication, and streamline the
          development process.
        </p>
        <p>
          Nx, short for “Nrwl Extensions,” is an open-source development toolkit
          designed to help teams manage monorepos more efficiently. Nx can be
          used with various front-end and back-end frameworks, including React,
          Angular, VueJS( in v17), NestJS, and more.
        </p>

        <h2>Why Use Nx?</h2>
        <p>
          Nx is beneficial for large-scale applications where multiple teams
          work on different parts of a system. By centralizing projects in a
          monorepo, Nx simplifies dependency management, encourages code reuse,
          and provides a unified build and test process. Here are some of the
          main advantages and potential drawbacks of using Nx:
        </p>

        <h4>Pros:</h4>
        <ul>
          <li>
            <b>1. Monorepo Management: </b> Nx excels at handling monorepos,
            which allows you to manage multiple projects (applications and
            libraries) in a single repository. This can simplify dependency
            management and code sharing.
          </li>
          <li>
            <b>2. Enhanced Developer Experience:</b> Nx provides a range of
            tools and plugins to streamline development, including generators
            for scaffolding new projects, and executors for running tasks like
            builds and tests. It also supports advanced code analysis and
            linting.
          </li>
          <li>
            <b>3. Workspace Integration:</b> Nx integrates well with popular
            tools and frameworks such as React, Angular, and Node.js. It
            provides first-class support for these frameworks and allows you to
            use them within the same workspace.
          </li>
          <li>
            <b>4. Code Sharing:</b> With Nx, you can create and manage shared
            libraries within your workspace. This promotes code reuse and
            consistency across different projects.
          </li>
          <li>
            <b>5. Optimized Builds:</b> Nx uses advanced build caching and
            computation caching techniques to speed up builds and tests. This
            can significantly reduce build times by reusing previous build
            outputs and test results.
          </li>
          <li>
            <b>6. Integrated Testing:</b> Nx has built-in support for testing
            with Jest and Cypress, making it easier to set up and run unit and
            end-to-end tests.
          </li>
          <li>
            <b>7. Extensible:</b> Nx is highly extensible and allows you to
            create custom plugins and schematics to suit your project’s needs.
          </li>
        </ul>

        <h4>Cons:</h4>
        <ul>
          <li>
            <b>1. Learning Curve:</b> Nx introduces additional concepts and
            tools that may require a learning curve, especially for developers
            unfamiliar with monorepos or the specific frameworks Nx supports.
          </li>
          <li>
            <b>2. Overhead for Small Projects:</b> For smaller projects or
            simpler setups, the overhead of configuring and maintaining an Nx
            workspace may not be justified. It’s more beneficial for larger
            projects with multiple applications and libraries.
          </li>
          <li>
            <b>3. Complexity: </b> Managing a monorepo with Nx can add
            complexity, particularly when dealing with many interdependencies
            between projects. This requires careful planning and organization.
          </li>
          <li>
            <b>4. Plugin Compatibility:</b> While Nx supports a wide range of
            plugins, you might encounter compatibility issues with some
            third-party tools or libraries. It’s important to ensure that the
            plugins you need are supported or can be integrated.
          </li>
          <li>
            <b>5. Performance Impact:</b> Although Nx’s caching mechanisms are
            designed to improve performance, the initial setup and configuration
            can sometimes introduce overhead that affects performance,
            especially in very large codebases.
          </li>
        </ul>

        <p>
          Despite these challenges, Nx offers significant benefits for teams
          looking to improve their development workflow and maintain
          high-quality codebases across multiple projects.
        </p>
        <h2 style="color: #0815ca">
          Creating an Nx Workspace with Shared Components
        </h2>
        <h3>Step 1: Install Nx CLI and Create a Workspace</h3>
        <p>First, install the Nx CLI globally and create a new Nx workspace:</p>
        <pre><code>npm install -g nx
npx create-nx-workspace@latest my-workspace</code></pre>
        <img
          src="./assets/workspace_creation.PNG"
          alt="workspace_creation"
          style="max-width: 100%"
        />
        <p>Initial Project folder structure looks as follows:</p>
        <img
          src="./assets/project_initial_setup.PNG"
          alt="project_initial_setup"
          style="max-width: 100%"
        />

        <h3>Step 2: Generate the Second React Project</h3>
        <p>
          Navigate to your workspace directory and generate a second React
          project:
        </p>
        <pre><code>cd my-workspace
nx generate @nrwl/react:application project-two</code></pre>
        <img
          src="./assets/Second_Project_Create.PNG"
          alt="project_initial_setup"
          style="max-width: 100%"
        />

        <h3>Step 3: Create a Sharable Library</h3>
        <p>Generate a new library for shared components:</p>
        <pre><code>nx generate @nrwl/react:library shared-ui</code></pre>

        <h3>Step 4: Create the Sharable Input Field</h3>
        <p>
          Navigate to the shared-ui library and create the CustomInput
          component:
        </p>
        <pre><code>cd shared-ui/src/lib/</code></pre>
        <p>
          Create a file named <code>CustomInput.tsx</code> with the following
          content:
        </p>
        <pre><code>
import React from 'react';
import './InputField.css';

interface InputFieldProps {
  label: string;
  value: string;
  onChange: (e: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; void;
}

const CustomInput: React.FC&lt;InputFieldProps&gt; = ({ label, value, onChange }) =&gt; {
  return (
    &lt;div className="input-field"&gt;
      &lt;label&gt;{label}&lt;/label&gt;
      &lt;input type="text" value={value} onChange={onChange} /&gt;
    &lt;/div&gt;
  );
};

export default CustomInput;
</code></pre>
        <img
          src="./assets/custom_input_tsx.PNG"
          alt="custom_input_tsx"
          style="max-width: 100%"
        />
        <p>Create a CSS file named <code>InputField.css</code>:</p>
        <pre><code>
.input-field {
  display: flex;
  flex-direction: column;
  margin-bottom: 16px;
}

.input-field label {
  margin-bottom: 8px;
  font-weight: bold;
}

.input-field input {
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 4px;
}
</code></pre>

        <h3>Step 5: Export the Component from the Library</h3>
        <p>
          Open <code>shared-ui/src/index.ts</code> and export the CustomInput
          component:
        </p>
        <pre><code>
export { default as CustomInput } from './lib/CustomInput';
export { default as SharedUI } from './lib/shared-ui';
</code></pre>

        <h3>Step 6: Use the Sharable Input Field in Both Projects</h3>
        <p>
          In Project One, open <code>apps/project-one/src/app/app.tsx</code> and
          use the CustomInput component:
        </p>
        <pre><code>
import React, { useState } from 'react';
import { CustomInput } from '@my-workspace/shared-ui';

export function App() {
  const [value, setValue] = useState('');

  return (
    &lt;div&gt;
      &lt;h1&gt;Project One&lt;/h1&gt;
      &lt;CustomInput label="Input Field" value={value} onChange={(e) =&gt; setValue(e.target.value)} /&gt;
      &lt;p&gt;Input Value: {value}&lt;/p&gt;
    &lt;/div&gt;
  );
}

export default App;
</code></pre>

        <p>
          In Project Two, open <code>apps/project-two/src/app/app.tsx</code> and
          use the CustomInput component:
        </p>
        <pre><code>
import React, { useState } from 'react';
import { CustomInput } from '@my-workspace/shared-ui';

export function App() {
  const [value, setValue] = useState('');

  return (
    &lt;div&gt;
      &lt;h1&gt;Project Two&lt;/h1&gt;
      &lt;CustomInput label="Input Field" value={value} onChange={(e) =&gt; setValue(e.target.value)} /&gt;
      &lt;p&gt;Input Value: {value}&lt;/p&gt;
    &lt;/div&gt;
  );
}

export default App;
</code></pre>

        <h3>Step 7: Serve the Projects</h3>
        <p>
          Finally, serve the projects to see the shared InputField component in
          action:
        </p>
        <pre><code>nx serve project-one
nx serve project-two</code></pre>
        <img
          src="./assets/project_one_start.PNG"
          alt="project_one_start"
          style="max-width: 100%"
        />
        <img
          src="./assets/project_one_output.PNG"
          alt="project_one_output"
          style="max-width: 100%"
        />
        <p>
          You should see the InputField component working in both projects. This
          demonstrates how you can create a sharable library in an Nx monorepo
          and use it across multiple applications.
        </p>

        <h2 style="color: #0815ca">Understanding Affected Commands</h2>
        <p>
          Nx has powerful tooling to help you understand the impact of changes
          in your monorepo. The affected commands are useful when you want to
          know which projects or libraries are affected by your recent changes.
          Here are some of the key affected commands:
        </p>
        <ul>
          <li>
            <code>nx affected:apps</code>: Lists the applications that are
            affected by the changes in your codebase.
          </li>
          <li>
            <code>nx affected:libs</code>: Lists the libraries that are affected
            by the changes in your codebase.
          </li>
          <li>
            <code>nx affected:dep-graph</code>: Generates a dependency graph
            showing how the projects in your workspace relate to each other and
            highlights the affected projects.
          </li>
          <li>
            <code>nx affected:test</code>: Runs tests only for the affected
            projects.
          </li>
          <li>
            <code>nx affected:lint</code>: Runs lint checks only for the
            affected projects.
          </li>
        </ul>
        <h4>Example Usage:</h4>
        <p>
          Suppose you made changes in the shared-ui library. To find out which
          applications are affected by this change, you can use:
        </p>
        <pre><code>nx affected:apps</code></pre>
        <p>
          If you want to see a visual representation of how the changes affect
          your projects:
        </p>
        <pre><code>nx affected:dep-graph</code></pre>
        <p>
          This will generate a graph showing the dependencies and highlight the
          affected projects and libraries.
        </p>

        <!-- New section: Build Commands -->
        <h2 style="color: #0815ca">Build Commands</h2>
        <p>
          The build command compiles the code for your projects. In an Nx
          workspace, you can build individual projects or build all projects at
          once. Here’s how you use the build commands:
        </p>
        <ul>
          <li>
            <code>nx build &lt;project-name&gt;</code>: Builds a specific
            project.
          </li>
          <li>
            <code>nx affected:build</code>: Builds only the affected projects.
          </li>
        </ul>
        <h4>Example Usage:</h4>
        <p>To build project-one, you would use:</p>
        <pre><code>nx build project-one</code></pre>
        <p>
          If you made changes and want to build only the affected projects
          (which might be more efficient than building everything), you can use:
        </p>
        <pre><code>nx affected:build</code></pre>
      </article>
    </main>

    <footer>
      <div class="container">
        <p>&copy; 2024 Sarath Molathoti. All rights reserved.</p>
        <div class="social-links">
          <a href="https://x.com/MolathotiSarath?s=09"
            ><i class="fab fa-twitter"></i> Twitter</a
          >
          |
          <a
            href="https://www.linkedin.com/in/molathoti-sarath-2276ba145?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app"
            ><i class="fab fa-linkedin-in"></i> LinkedIn</a
          >
          |
          <a
            href="https://www.instagram.com/thisis_sarath_m?igsh=MTR3eGlpdHl0aGFpNQ=="
            ><i class="fab fa-instagram"></i> Instagram</a
          >
        </div>
      </div>
    </footer>
  </body>
</html>
